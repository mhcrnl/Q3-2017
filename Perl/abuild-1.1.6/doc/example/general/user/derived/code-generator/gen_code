#!/usr/bin/env perl
BEGIN { $^W = 1; }
use strict;

my ($src, $hdr, $infile) = @ARGV;

open(IN, "<$infile") or die "can't read $infile: $!\n";
my $num = <IN>;
close(IN);
$num =~ s/\r?\n//g;
die "$infile: must contain a number\n" unless $num =~ m/^\d+$/;

open(H, ">$hdr") or die "can't create $hdr: $!\n";
print H <<EOF
/* This file is automatically generated.  Do not edit. */

#ifdef __cplusplus
extern "C" {
#endif

extern int getNumber();

#ifdef __cplusplus
}
#endif

EOF
    ;
close(H);

open(S, ">$src") or die "can't create $src: $!\n";

print S <<EOF
#include "$hdr"
int getNumber()
{
    return $num;
}
EOF
    ;
close(S);
